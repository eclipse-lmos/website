"use strict";(self.webpackChunklmos_website=self.webpackChunklmos_website||[]).push([[8081],{987:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>o,toc:()=>l});var r=t(4848),s=t(8453);const i={},a="Agent GraphQL",o={id:"arc/spring/graphql",title:"Agent GraphQL",description:"The Arc GraphQL Spring Boot Starter provides a GraphQL API for interacting with Arc Agents.",source:"@site/docs/arc/05-spring/graphql.md",sourceDirName:"arc/05-spring",slug:"/arc/spring/graphql",permalink:"/lmos/docs/arc/spring/graphql",draft:!1,unlisted:!1,editUrl:"https://github.com/eclipse-lmos/website/edit/source/docs/arc/05-spring/graphql.md",tags:[],version:"current",frontMatter:{},sidebar:"arcSidebar",previous:{title:"Agent Beans",permalink:"/lmos/docs/arc/spring/agent-beans"},next:{title:"Metrics",permalink:"/lmos/docs/arc/spring/metrics"}},c={},l=[{value:"Agent Subscription",id:"agent-subscription",level:3},{value:"Agent Query",id:"agent-query",level:3},{value:"Setup",id:"setup",level:3},{value:"Event Subscriptions",id:"event-subscriptions",level:3},{value:"Graphiql",id:"graphiql",level:3}];function p(e){const n={a:"a",code:"code",h1:"h1",h3:"h3",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"agent-graphql",children:"Agent GraphQL"})}),"\n",(0,r.jsx)(n.p,{children:"The Arc GraphQL Spring Boot Starter provides a GraphQL API for interacting with Arc Agents."}),"\n",(0,r.jsxs)(n.p,{children:["(Hint: Checkout the Project at ",(0,r.jsx)(n.a,{href:"https://github.com/eclipse-lmos/arc-spring-init",children:"https://github.com/eclipse-lmos/arc-spring-init"})," for a quick start.)"]}),"\n",(0,r.jsx)(n.p,{children:"Once added to a Spring Boot Application, the following endpoints are available:"}),"\n",(0,r.jsx)(n.h3,{id:"agent-subscription",children:"Agent Subscription"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"Agent Subscription"})," endpoint allows you to send a request to an Agent and receive a stream of responses."]}),"\n",(0,r.jsx)(n.p,{children:"The advantage of using a graphql subscription over a standard rest/http endpoint is that the\nwebsocket connection that is created in the background is more robust against timeouts."}),"\n",(0,r.jsx)(n.p,{children:"Furthermore, the subscription enables the Agent to send multiple responses to each request.\nThis can be helpful, for example, when the Agent is executing long-running tasks and wants to provide updates to the user."}),"\n",(0,r.jsx)(n.p,{children:"Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:'subscription {\n    agent(\n        agentName: "assistant-agent"\n        request: {\n            conversationContext: {\n                conversationId: "1"\n            }\n            systemContext: [],\n            userContext: {\n                userId: "1234",\n                profile: [{\n                    key: "name",\n                    value: "Pat"\n                }]\n            },\n            messages: [\n                {\n                    role: "user",\n                    content: "Hi",\n                    format: "text",\n                }\n            ]\n        }\n    ) {\n        messages {\n            content\n        }\n    }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["See the ",(0,r.jsx)(n.a,{href:"/lmos/docs/arc/api",children:"Arc API"})," for more details on the data models and interfaces."]}),"\n",(0,r.jsx)(n.h3,{id:"agent-query",children:"Agent Query"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"Agent Query"})," endpoint returns the list of agents that are active on the server."]}),"\n",(0,r.jsx)(n.p,{children:"Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:"query {\n    agent {\n        names\n    }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"setup",children:"Setup"}),"\n",(0,r.jsx)(n.p,{children:"Add the following dependencies to your project:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-kts",children:'implementation("org.eclipse.lmos:arc-api:$arcVersion")\nimplementation("org.eclipse.lmos:arc-graphql-spring-boot-starter:$arcVersion")\nimplementation("org.eclipse.lmos:arc-spring-boot-starter:$arcVersion") // recommended\n'})}),"\n",(0,r.jsx)(n.h3,{id:"event-subscriptions",children:"Event Subscriptions"}),"\n",(0,r.jsx)(n.p,{children:"To better debug the Agents, a further graphql subscription can be enabled that provides access to\nall the events emitted by the Arc application."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:"subscription {\n    events {\n        type\n        payload\n        conversationId\n    }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The feature is disabled by default. Add the following to your ",(0,r.jsx)(n.code,{children:"application.yml"})," to enable it:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"arc:\n  subscriptions:\n    events:\n      enable: true\n"})}),"\n",(0,r.jsx)(n.h3,{id:"graphiql",children:"Graphiql"}),"\n",(0,r.jsxs)(n.p,{children:["The Graphiql UI is available at ",(0,r.jsx)(n.code,{children:"http://localhost:8080/graphiql?path=/graphql"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Add the following to your ",(0,r.jsx)(n.code,{children:"application.yml"})," to enable it:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"spring:\n graphql:\n   graphiql:\n    enabled: true\n"})})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var r=t(6540);const s={},i=r.createContext(s);function a(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);