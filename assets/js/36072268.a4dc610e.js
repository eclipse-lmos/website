"use strict";(self.webpackChunklmos_website=self.webpackChunklmos_website||[]).push([[5949],{9979:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"getting_started/kotlin_sdk","title":"LMOS Kotlin SDK","description":"How to use the LMOS Kotlin SDK","source":"@site/docs/getting_started/03-kotlin_sdk.md","sourceDirName":"getting_started","slug":"/getting_started/kotlin_sdk","permalink":"/lmos/docs/getting_started/kotlin_sdk","draft":false,"unlisted":false,"editUrl":"https://github.com/eclipse-lmos/website/edit/source/docs/getting_started/03-kotlin_sdk.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"LMOS Kotlin SDK","description":"How to use the LMOS Kotlin SDK"},"sidebar":"lmosSidebar","previous":{"title":"Installation","permalink":"/lmos/docs/getting_started/installation"},"next":{"title":"Multi-Agent System","permalink":"/lmos/docs/category/multi-agent-system"}}');var a=t(4848),s=t(8453);const r={title:"LMOS Kotlin SDK",description:"How to use the LMOS Kotlin SDK"},o=void 0,l={},c=[{value:"Quick Start Guide",id:"quick-start-guide",level:2},{value:"Adding the Kotlin Server SDK",id:"adding-the-kotlin-server-sdk",level:3},{value:"Using Gradle",id:"using-gradle",level:4},{value:"Using Maven",id:"using-maven",level:4},{value:"Create an AgentApplication",id:"create-an-agentapplication",level:3},{value:"Create an Agent",id:"create-an-agent",level:3},{value:"Data Model",id:"data-model",level:3},{value:"Implementing the ConversationalAgent Interface",id:"implementing-the-conversationalagent-interface",level:3},{value:"Create a AgentConfiguration",id:"create-a-agentconfiguration",level:3},{value:"Create an application.yaml",id:"create-an-applicationyaml",level:3},{value:"Query the Agent Description",id:"query-the-agent-description",level:3},{value:"Using Spring Boot to Create an OCI Image",id:"using-spring-boot-to-create-an-oci-image",level:3},{value:"Using Gradle",id:"using-gradle-1",level:4},{value:"Using Maven",id:"using-maven-1",level:4},{value:"Adding the Kotlin Client SDK",id:"adding-the-kotlin-client-sdk",level:3},{value:"Using Gradle",id:"using-gradle-2",level:4},{value:"Using Maven",id:"using-maven-2",level:4},{value:"Communicating with an Agent",id:"communicating-with-an-agent",level:3},{value:"Use the Arc view",id:"use-the-arc-view",level:3},{value:"Create an OCI Image",id:"create-an-oci-image",level:3},{value:"Using Gradle",id:"using-gradle-3",level:4},{value:"Using Maven",id:"using-maven-3",level:4},{value:"Creating and Publishing a Helm Chart",id:"creating-and-publishing-a-helm-chart",level:3},{value:"Step 1: Apply the Plugins",id:"step-1-apply-the-plugins",level:4},{value:"Step 2: Configure the Helm Chart",id:"step-2-configure-the-helm-chart",level:4},{value:"Step 3: Replace Chart Version",id:"step-3-replace-chart-version",level:4},{value:"Step 4: Publish the Helm Chart",id:"step-4-publish-the-helm-chart",level:4},{value:"Step 5: Build and Publish",id:"step-5-build-and-publish",level:4}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"quick-start-guide",children:"Quick Start Guide"}),"\n",(0,a.jsx)(n.p,{children:"This guide will help you quickly get started with the LMOS Kotlin Client & Server SDK.\nIt walks you through developing an Agent."}),"\n",(0,a.jsxs)(n.p,{children:["The LMOS Kotlin Server SDK allows you to create Agents based on ",(0,a.jsx)(n.a,{href:"https://spring.io/projects/spring-boot",children:"Spring Boot"})," and ",(0,a.jsx)(n.a,{href:"https://ktor.io/",children:"Ktor"}),". The following diagram illustrates the technology stack of the LMOS Kotlin SDK."]}),"\n",(0,a.jsxs)(n.p,{children:["The LMOS Kotlin Server SDK enables the implementation of Agents by leveraging the LMOS protocol. It leverages ",(0,a.jsx)(n.a,{href:"https://github.com/eclipse-thingweb/kotlin-wot",children:"Eclipse ThingWeb"})," to ensure semantic WoT compatibility and supports HTTP, WebSocket and MQTT protocol bindings for flexible communication. The Agent runs within a Spring Boot application, which internally uses Ktor to handle the underlying protocol bindings. For observability, the SDK integrates ",(0,a.jsx)(n.a,{href:"https://opentelemetry.io/",children:"OpenTelemetry"}),", providing comprehensive support for logs, metrics, and traces."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.img,{alt:"Technology Stack",src:t(2857).A+"#light-mode-only",width:"1040",height:"647"}),"\n",(0,a.jsx)(n.img,{alt:"Technology Stack",src:t(1817).A+"#dark-mode-only",width:"1040",height:"647"})]}),"\n",(0,a.jsx)(n.h3,{id:"adding-the-kotlin-server-sdk",children:"Adding the Kotlin Server SDK"}),"\n",(0,a.jsx)(n.p,{children:"To use the LMOS Kotlin Server SDK in your project, you need to add the following dependency to your build configuration:"}),"\n",(0,a.jsx)(n.h4,{id:"using-gradle",children:"Using Gradle"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-kotlin",children:'dependencies {\n    implementation("org.eclipse.lmos:lmos-kotlin-sdk-server:0.1.0-SNAPSHOT")\n    implementation("org.eclipse.thingweb:kotlin-wot-binding-http:0.1.0-SNAPSHOT")\n    // If you want to support websocket\n    //implementation("org.eclipse.thingweb:kotlin-wot-binding-websocket:0.1.0-SNAPSHOT"  \n}\n\nrepositories {\n    maven {\n        url \'https://oss.sonatype.org/content/repositories/snapshots/\'\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h4,{id:"using-maven",children:"Using Maven"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-xml",children:"<dependencies>\n    <dependency>\n        <groupId>org.eclipse.lmos</groupId>\n        <artifactId>lmos-kotlin-sdk-server</artifactId>\n        <version>0.1.0-SNAPSHOT</version>\n    </dependency>\n    <dependency>\n        <groupId>org.eclipse.lmos</groupId>\n        <artifactId>kotlin-wot-binding-http</artifactId>\n        <version>0.1.0-SNAPSHOT</version>\n    </dependency>\n    \x3c!--\n    <dependency>\n        <groupId>org.eclipse.lmos</groupId>\n        <artifactId>kotlin-wot-binding-websocket</artifactId>\n        <version>0.1.0-SNAPSHOT</version>\n    </dependency>  \n    --\x3e     \n</dependencies>\n\n<repositories>\n    <repository>\n        <id>sonatype-snapshots</id>\n        <url>https://oss.sonatype.org/content/repositories/snapshots/</url>\n        <snapshots>\n            <enabled>true</enabled>\n        </snapshots>\n    </repository>\n</repositories>\n"})}),"\n",(0,a.jsx)(n.h3,{id:"create-an-agentapplication",children:"Create an AgentApplication"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"AgentApplication"})," is the entry point of the Spring Boot application."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-kotlin",children:"fun main(args: Array<String>) {\n    runApplication<AgentApplication>(*args)\n}\n\n@SpringBootApplication\nclass AgentApplication {}\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"create-an-agent",children:"Create an Agent"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"ChatAgent"})," is a specific implementation of an agent that handles conversational interactions."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-kotlin",children:'@Thing(id="chatagent", title="Chat Agent", description="A chat agent.", type= LMOSThingTypes.AGENT)\n@Context(prefix = LMOSContext.prefix, url = LMOSContext.url)\n@Component\nclass ChatAgent(private val arcAgent: ConversationalAgent) {\n\n    @Action(title = "Chat", description = "Ask the agent a question.")\n    @ActionInput(title = "A question", description = "A question of a user")\n    @ActionOutput(title = "An answer", description = "An Answer of the agent")\n    suspend fun chat(message: AgentRequest) : AgentResult {\n        return arcAgent.chat(message)\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"data-model",children:"Data Model"}),"\n",(0,a.jsxs)(n.p,{children:["The LMOS SDK currently utilizes the ",(0,a.jsx)(n.a,{href:"https://eclipse.dev/lmos/docs/arc/ccore/api/",children:"ARC API Data Model"})," for Conversational Agents.\nThe Data Classes can be found ",(0,a.jsx)(n.a,{href:"https://github.com/eclipse-lmos/lmos-kotlin-sdk/tree/main/lmos-kotlin-sdk-base/src/main/kotlin/sdk/model",children:"here"})]}),"\n",(0,a.jsx)(n.p,{children:"Please note that the LMOS SDK data model is subject to change once a standardized, interoperable data model for agent communication becomes available."}),"\n",(0,a.jsxs)(n.p,{children:["However, you're not limited to using ",(0,a.jsx)(n.code,{children:"AgentRequest"})," and ",(0,a.jsx)(n.code,{children:"AgentResult"}),". You are free to define your own custom data model if it better suits your use case."]}),"\n",(0,a.jsx)(n.p,{children:"Example of an AgentRequest message:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n    "conversationContext": {\n        "conversationId": "1"\n    },\n    "systemContext": [\n        {\n            "key": "channelId",\n            "value": "web"\n        }\n    ],\n    "userContext": {\n        "userId": "1234",\n        "profile": [\n        {\n            "key": "name",\n            "value": "Max Mustermann"\n        }\n        ]\n    },\n    "messages": [\n        {\n        "role": "user",\n        "content": "What is the weather in London?",\n        "format": "text"\n        }\n    ]\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"Example of an AgentResult message:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "status": "success",\n  "messages": [\n    {\n      "role": "agent",\n      "content": "The weather is sunny.",\n      "format": "text"\n    }\n  ]\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"implementing-the-conversationalagent-interface",children:"Implementing the ConversationalAgent Interface"}),"\n",(0,a.jsxs)(n.p,{children:["When creating a conversational agent, the ",(0,a.jsx)(n.code,{children:"ConversationalAgent"})," interface must be implemented. This ensures that the agent adheres to a standard structure for handling conversational interactions, making it compatible with the LMOS ecosystem."]}),"\n",(0,a.jsxs)(n.p,{children:["When implementing an agent, the ",(0,a.jsx)(n.a,{href:"https://eclipse.dev/lmos/arc2/index.html",children:"LMOS ARC"})," framework is commonly used due to its seamless integration with the LMOS ecosystem. ARC Agents can either be injected or retrieved from the AgentProvider."]}),"\n",(0,a.jsx)(n.p,{children:"However, other frameworks like Langchain4j can also be utilized, offering flexibility depending on your project requirements and preferences."}),"\n",(0,a.jsxs)(n.p,{children:["Below is an example of how to implement the ",(0,a.jsx)(n.code,{children:"ConversationalAgent"})," interface with ARC:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-kotlin",children:'@Component\nclass ArcConversationalAgent(agentProvider: AgentProvider) : ConversationalAgent {\n    private val agent = agentProvider.getAgentByName("ChatAgent") as ChatAgent\n\n    override suspend fun chat(message: AgentRequest): AgentResult {\n        return executeAgent(message, agent::execute)\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"create-a-agentconfiguration",children:"Create a AgentConfiguration"}),"\n",(0,a.jsx)(n.p,{children:"The configuration for the ARC agent is typically handled by Spring Boot's dependency injection and configuration mechanisms. This ensures that the agent is properly initialized and ready to handle requests. The ARC DSL (Domain-Specific Language) is used to define the behavior and functionality of the Agent in a concise and elegant manner. By leveraging the ARC DSL, developers can specify the Agent's name, prompt, tools, and other configurations in a structured and readable format."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-kotlin",children:'@Configuration\nclass AgentConfiguration {\n\n    @Bean\n    fun chatArcAgent(agent: Agents) = agent {\n        name = "ChatAgent"\n        prompt {\n            """\n            You are a professional assistant. \n            """\n        }\n        model = { "GPT-4o" }\n        tools = AllTools\n    }\n\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"create-an-applicationyaml",children:"Create an application.yaml"}),"\n",(0,a.jsx)(n.p,{children:"To configure your agent, you need to create an application.yaml file and place it in the resources folder of your project. This file is essential for defining the configuration settings for your agent, such as its name, AI client details, and protocol support."}),"\n",(0,a.jsx)(n.p,{children:"In the application.yaml file, you can enable both HTTP and WebSocket protocols simultaneously by setting their enabled properties to true. This allows your agent to handle requests over both protocols in parallel."}),"\n",(0,a.jsx)(n.p,{children:"Here\u2019s an example configuration:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"spring:\n  application:\n    name: chat-agent\n\narc:\n  ai:\n    clients:\n      - id: GPT-4o   // The id must match the model in the AgentConfiguration\n        model-name: <model>\n        api-key: <key>\n        client: openai\n        url: <url>\n\nwot:\n  servient:\n    websocket:\n      server:\n        enabled: true\n        host: localhost\n        port: 8181\n    http:\n      server:\n        enabled: true\n        host: localhost\n        port: 9080\n"})}),"\n",(0,a.jsx)(n.h3,{id:"query-the-agent-description",children:"Query the Agent Description"}),"\n",(0,a.jsxs)(n.p,{children:["The endpoint ",(0,a.jsx)(n.code,{children:"http://localhost:9080/chatagent"})," is the URL where the Agent Description is hosted. This endpoint serves as the interface for clients to communicate with the Agent. It acts as the central access point for integrating the Agent into your application or system."]}),"\n",(0,a.jsx)(n.p,{children:"Example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n    "id": "chatagent",\n    "title": "Chat Agent",\n    "@context": [\n        "https://www.w3.org/2022/wot/td/v1.1",\n        {\n            "lmos": "https://eclipse.dev/lmos/protocol/v1"\n        }\n    ],\n    "@type": "lmos:Agent",\n    "version": {\n        "instance": "1.0.0"\n    },\n    "description": "A chat agent.",\n    "actions": {\n        "chat": {\n            "description": "Ask the agent a question.",\n            "forms": [\n                {\n                    "href": "http://localhost:9080/chatagent/actions/chat",\n                    "contentType": "application/json",\n                    "op": [\n                        "invokeaction"\n                    ]\n                }\n            ],\n            "input": {\n                "type": "object",\n                "properties": {\n                    ...\n                },\n                "required": [\n                    "messages"\n                ],\n                "title": "The question",\n                "description": "A question"\n            },\n            "output": {\n                "type": "object",\n                "title": "The answer",\n                "description": "The Answer",\n                "properties": {\n                   ...\n                },\n                "required": [\n                    "messages"\n                ]\n            },\n            "synchronous": true\n        }\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"using-spring-boot-to-create-an-oci-image",children:"Using Spring Boot to Create an OCI Image"}),"\n",(0,a.jsx)(n.p,{children:"Spring Boot provides built-in support for creating OCI (Open Container Initiative) images from your application JAR file using Cloud Native Buildpacks (CNB). This can be done using either Gradle or Maven."}),"\n",(0,a.jsx)(n.h4,{id:"using-gradle-1",children:"Using Gradle"}),"\n",(0,a.jsxs)(n.p,{children:["To create an OCI image with Gradle, ensure that the ",(0,a.jsx)(n.code,{children:"spring-boot"})," plugin is applied in your ",(0,a.jsx)(n.code,{children:"build.gradle"})," file. Then, use the ",(0,a.jsx)(n.code,{children:"bootBuildImage"})," task to generate the image."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-gradle",children:"plugins {\n    id 'org.springframework.boot' version '3.0.0'\n    id 'io.spring.dependency-management' version '1.1.0'\n    id 'java'\n}\n\nspringBoot {\n    buildImage {\n        imageName = 'your-docker-repo/your-app-name:latest'\n    }\n}\n\nTo build the OCI image, run the following command:\n\n```bash\ngradle bootBuildImage\n"})}),"\n",(0,a.jsx)(n.p,{children:"This will create an OCI image and push it to the specified Docker repository if configured."}),"\n",(0,a.jsx)(n.h4,{id:"using-maven-1",children:"Using Maven"}),"\n",(0,a.jsxs)(n.p,{children:["To create an OCI image with Maven, ensure that the ",(0,a.jsx)(n.code,{children:"spring-boot-maven-plugin"})," is configured in your ",(0,a.jsx)(n.code,{children:"pom.xml"})," file. Then, use the ",(0,a.jsx)(n.code,{children:"spring-boot:build-image"})," goal to generate the image."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-xml",children:"<build>\n    <plugins>\n        <plugin>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-maven-plugin</artifactId>\n            <version>3.0.0</version>\n            <configuration>\n                <image>\n                    <name>your-docker-repo/your-app-name:latest</name>\n                </image>\n            </configuration>\n        </plugin>\n    </plugins>\n</build>\n"})}),"\n",(0,a.jsx)(n.p,{children:"To build the OCI image, run the following command:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"mvn spring-boot:build-image\n"})}),"\n",(0,a.jsx)(n.p,{children:"This will create an OCI image and push it to the specified Docker repository if configured."}),"\n",(0,a.jsx)(n.h3,{id:"adding-the-kotlin-client-sdk",children:"Adding the Kotlin Client SDK"}),"\n",(0,a.jsx)(n.p,{children:"To use the LMOS Kotlin Client SDK in your project, you need to add the following dependency to your build configuration:"}),"\n",(0,a.jsx)(n.h4,{id:"using-gradle-2",children:"Using Gradle"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-kotlin",children:'dependencies {\n    implementation("org.eclipse.lmos:lmos-kotlin-sdk-client:0.1.0-SNAPSHOT")\n    implementation("org.eclipse.thingweb:kotlin-wot-binding-http:0.1.0-SNAPSHOT")\n    // If you want to support websocket\n    //implementation("org.eclipse.thingweb:kotlin-wot-binding-websocket:0.1.0-SNAPSHOT" \n}\n\nrepositories {\n    maven {\n        url \'https://oss.sonatype.org/content/repositories/snapshots/\'\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h4,{id:"using-maven-2",children:"Using Maven"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-xml",children:"<dependencies>\n    <dependency>\n        <groupId>org.eclipse.lmos</groupId>\n        <artifactId>lmos-kotlin-sdk-client</artifactId>\n        <version>0.1.0-SNAPSHOT</version>\n    </dependency>\n    <dependency>\n        <groupId>org.eclipse.lmos</groupId>\n        <artifactId>kotlin-wot-binding-http</artifactId>\n        <version>0.1.0-SNAPSHOT</version>\n    </dependency>\n    \x3c!--\n    <dependency>\n        <groupId>org.eclipse.lmos</groupId>\n        <artifactId>kotlin-wot-binding-websocket</artifactId>\n        <version>0.1.0-SNAPSHOT</version>\n    </dependency>\n    --\x3e\n</dependencies>\n\n<repositories>\n    <repository>\n        <id>sonatype-snapshots</id>\n        <url>https://oss.sonatype.org/content/repositories/snapshots/</url>\n        <snapshots>\n            <enabled>true</enabled>\n        </snapshots>\n    </repository>\n</repositories>\n"})}),"\n",(0,a.jsx)(n.h3,{id:"communicating-with-an-agent",children:"Communicating with an Agent"}),"\n",(0,a.jsxs)(n.p,{children:["The LMOS Kotlin Client SDK enables communication with an LMOS agent. The ",(0,a.jsx)(n.code,{children:"WotConversationalAgent"})," only requires the Agent Description (TD) endpoint to create a proxy that can be used to invoke actions or subscribe to events."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-kotlin",children:'val agent = WotConversationalAgent\n    .create("http://localhost:9080/weather-agent")\n\n\n// Interacting with the agent via chat\nval answer = agent.chat("What is the weather in London?")\n\n// Consuming an event from the agent, \n// but the ChatAgent does not provide any events in this example\nagent.consumeEvent("agentEvent") {\n    println("Event: $it")\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"use-the-arc-view",children:"Use the Arc view"}),"\n",(0,a.jsxs)(n.p,{children:["LMOS Arc View provides a graphical user interface that allows you to interact with the Arc Agent and get more insights.\nFor more details see ",(0,a.jsx)(n.a,{href:"https://eclipse.dev/lmos/docs/arc/view/",children:"Arc View"})]}),"\n",(0,a.jsx)(n.h3,{id:"create-an-oci-image",children:"Create an OCI Image"}),"\n",(0,a.jsx)(n.p,{children:"Spring Boot provides built-in support for creating OCI (Open Container Initiative) images from your application JAR file using Cloud Native Buildpacks (CNB). This can be done using either Gradle or Maven."}),"\n",(0,a.jsx)(n.h4,{id:"using-gradle-3",children:"Using Gradle"}),"\n",(0,a.jsxs)(n.p,{children:["To create an OCI image with Gradle, ensure that the ",(0,a.jsx)(n.code,{children:"spring-boot"})," plugin is applied in your ",(0,a.jsx)(n.code,{children:"build.gradle"})," file. Then, use the ",(0,a.jsx)(n.code,{children:"bootBuildImage"})," task to generate the image."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-gradle",children:'plugins {\n    java\n    id("org.springframework.boot") version "3.4.4"\n    id("org.jetbrains.kotlin.plugin.spring") version "2.1.20"\n    id("io.spring.dependency-management") version "1.1.7"\n    kotlin("jvm") version "2.1.20"\n}\n\ntasks.named<BootBuildImage>("bootBuildImage") {\n    group = "publishing"\n    if ((System.getenv("REGISTRY_URL") ?: project.findProperty("REGISTRY_URL")) != null) {\n        val registryUrl = getProperty("REGISTRY_URL")\n        val registryUsername = getProperty("REGISTRY_USERNAME")\n        val registryPassword = getProperty("REGISTRY_PASSWORD")\n        val registryNamespace = getProperty("REGISTRY_NAMESPACE")\n\n        imageName.set("$registryUrl/$registryNamespace/${rootProject.name}:${project.version}")\n        publish = true\n        docker {\n            publishRegistry {\n                url.set(registryUrl)\n                username.set(registryUsername)\n                password.set(registryPassword)\n            }\n        }\n    } else {\n        imageName.set("${rootProject.name}:${project.version}")\n        publish = false\n    }\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"To build the OCI image, run the following command:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"gradle bootBuildImage\n"})}),"\n",(0,a.jsx)(n.p,{children:"This will create an OCI image and push it to the specified Docker repository if configured."}),"\n",(0,a.jsx)(n.h4,{id:"using-maven-3",children:"Using Maven"}),"\n",(0,a.jsxs)(n.p,{children:["To create an OCI image with Maven, ensure that the ",(0,a.jsx)(n.code,{children:"spring-boot-maven-plugin"})," is configured in your ",(0,a.jsx)(n.code,{children:"pom.xml"})," file. Then, use the ",(0,a.jsx)(n.code,{children:"spring-boot:build-image"})," goal to generate the image."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-xml",children:"<build>\n    <plugins>\n        <plugin>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-maven-plugin</artifactId>\n            <version>3.0.0</version>\n            <configuration>\n                <image>\n                    <name>your-docker-repo/your-app-name:latest</name>\n                </image>\n            </configuration>\n        </plugin>\n    </plugins>\n</build>\n"})}),"\n",(0,a.jsx)(n.p,{children:"To build the OCI image, run the following command:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"mvn spring-boot:build-image\n"})}),"\n",(0,a.jsx)(n.p,{children:"This will create an OCI image and push it to the specified Docker repository if configured."}),"\n",(0,a.jsx)(n.h3,{id:"creating-and-publishing-a-helm-chart",children:"Creating and Publishing a Helm Chart"}),"\n",(0,a.jsxs)(n.p,{children:["To create and publish a Helm chart using Gradle, you can use the ",(0,a.jsx)(n.code,{children:"com.citi.helm"})," and ",(0,a.jsx)(n.code,{children:"com.citi.helm-publish"})," plugins. Below is an example configuration:"]}),"\n",(0,a.jsx)(n.h4,{id:"step-1-apply-the-plugins",children:"Step 1: Apply the Plugins"}),"\n",(0,a.jsxs)(n.p,{children:["Add the following plugins to your ",(0,a.jsx)(n.code,{children:"build.gradle"})," file:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-gradle",children:'plugins {\n    id("com.citi.helm") version "2.2.0"\n    id("com.citi.helm-publish") version "2.2.0"\n}\n'})}),"\n",(0,a.jsx)(n.h4,{id:"step-2-configure-the-helm-chart",children:"Step 2: Configure the Helm Chart"}),"\n",(0,a.jsxs)(n.p,{children:["Define the Helm chart configuration in your ",(0,a.jsx)(n.code,{children:"build.gradle"})," file:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-gradle",children:'helm {\n    charts {\n        create("main") {\n            chartName.set("${rootProject.name}-chart")\n            chartVersion.set("${project.version}")\n            sourceDir.set(file("src/main/helm"))\n        }\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h4,{id:"step-3-replace-chart-version",children:"Step 3: Replace Chart Version"}),"\n",(0,a.jsxs)(n.p,{children:["Create a task to replace the chart version dynamically in the ",(0,a.jsx)(n.code,{children:"Chart.yaml"})," file:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-gradle",children:'tasks.register("replaceChartVersion") {\n    doLast {\n        val chartFile = file("src/main/helm/Chart.yaml")\n        val content = chartFile.readText()\n        val updatedContent = content.replace("\\${chartVersion}", "${project.version}")\n        chartFile.writeText(updatedContent)\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h4,{id:"step-4-publish-the-helm-chart",children:"Step 4: Publish the Helm Chart"}),"\n",(0,a.jsx)(n.p,{children:"Define a task to publish the Helm chart to an OCI registry:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-gradle",children:'tasks.register("helmPush") {\n    description = "Push Helm chart to OCI registry"\n    group = "publishing"\n    dependsOn(tasks.named("helmPackageMainChart"))\n\n    doLast {\n        if ((System.getenv("REGISTRY_URL") ?: project.findProperty("REGISTRY_URL")) != null) {\n            val registryUrl = getProperty("REGISTRY_URL")\n            val registryUsername = getProperty("REGISTRY_USERNAME")\n            val registryPassword = getProperty("REGISTRY_PASSWORD")\n            val registryNamespace = getProperty("REGISTRY_NAMESPACE")\n\n            helm.execHelm("registry", "login") {\n                option("-u", registryUsername)\n                option("-p", registryPassword)\n                args(registryUrl)\n            }\n\n            helm.execHelm("push") {\n                args(\n                    tasks\n                        .named("helmPackageMainChart")\n                        .get()\n                        .outputs.files.singleFile\n                        .toString(),\n                )\n                args("oci://$registryUrl/$registryNamespace")\n            }\n\n            helm.execHelm("registry", "logout") {\n                args(registryUrl)\n            }\n        }\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h4,{id:"step-5-build-and-publish",children:"Step 5: Build and Publish"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Run the ",(0,a.jsx)(n.code,{children:"replaceChartVersion"})," task to update the chart version:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"./gradlew replaceChartVersion\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Package the Helm chart:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"./gradlew helmPackageMainChart\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Push the Helm chart to the OCI registry:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"./gradlew helmPush\n"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["Ensure that the required environment variables (",(0,a.jsx)(n.code,{children:"REGISTRY_URL"}),", ",(0,a.jsx)(n.code,{children:"REGISTRY_USERNAME"}),", ",(0,a.jsx)(n.code,{children:"REGISTRY_PASSWORD"}),", ",(0,a.jsx)(n.code,{children:"REGISTRY_NAMESPACE"}),") are set before running the ",(0,a.jsx)(n.code,{children:"helmPush"})," task."]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},1817:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/technology_stack-dark-55641fa854963af2884200918b001cfa.png"},2857:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/technology_stack-light-ee9064303883a1a9b057475bb894658d.png"},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>o});var i=t(6540);const a={},s=i.createContext(a);function r(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);